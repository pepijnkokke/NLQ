------------------------------------------------------------------------
-- The Lambek Calculus in Agda
--
-- Implements several views on proofs in the system ResMon which are
-- heavily used in the proof of admissibility of the transitivity rule.
--
-- One advantage of the residuation-monotonicity calculus is that
-- every connective *must* be introduced by an application of the
-- corresponding monotonicity-rule. The proofs in the `Origin` module
-- can be used to construct a view on a proof that makes this
-- introducing application of a monotonicity-rule explicit.
--
-- The proofs in this module are highly repetitive, and the decision
-- procedures and data structures could be abstracted over by
-- generalising over the connectives (cutting the file length by ±750
-- lines). However, I feel that abstracting over connectives would
-- make the logic a lot harder to read. I may do it in the future
-- anyway.
------------------------------------------------------------------------


open import Relation.Binary.PropositionalEquality as P using (_≡_; refl; cong)


module Logic.Classical.Ordered.LambekGrishin.ResMon.Origin {ℓ} (Univ : Set ℓ) where


open import Logic.Polarity
open import Logic.Classical.Ordered.LambekGrishin.Type                               Univ as T
open import Logic.Classical.Ordered.LambekGrishin.Type.Context                       Univ as TC
open import Logic.Classical.Ordered.LambekGrishin.Type.Context.Polarised             Univ as TCP hiding (Polarised)
open import Logic.Classical.Ordered.LambekGrishin.ResMon.Judgement                   Univ
open import Logic.Classical.Ordered.LambekGrishin.ResMon.Judgement.Context           Univ as JC
open import Logic.Classical.Ordered.LambekGrishin.ResMon.Judgement.Context.Polarised Univ as JCP
open import Logic.Classical.Ordered.LambekGrishin.ResMon.Base                        Univ as LGB
open import Logic.Classical.Ordered.LambekGrishin.ResMon.Derivation                  Univ as LGD


open  JC.Simple renaming (_[_] to _[_]ᴶ)
open LGD.Simple renaming (_[_] to _[_]ᴰ; _<_> to _<_>ᴰ; <>-def to <>ᴰ-def)


module el where

  data Origin {J B} (J⁺ : Polarised + J) (f : LG J [ el B ]ᴶ) : Set ℓ where
       origin : (f′ : ∀ {G} → LG G ⊢ el B ⋯ J [ G ]ᴶ)
              → (pr : f ≡ f′ [ ax ]ᴰ)
              → Origin J⁺ f



  mutual
    viewOrigin : ∀ {J B} (J⁺ : Polarised + J) (f : LG J [ el B ]ᴶ) → Origin J⁺ f
    viewOrigin ([] <⊢ ._)       ax             = origin [] refl
    viewOrigin ([] <⊢ ._)       (r⊗⇒ f)     = go ((_ ⊗> []) <⊢ _)       f  (r⊗⇒ [])
    viewOrigin ([] <⊢ ._)       (r⊗⇐ f)     = go (([] <⊗ _) <⊢ _)       f  (r⊗⇐ [])
    viewOrigin ([] <⊢ ._)       (r⇛⊕ f)     = go ((_ ⇛> []) <⊢ _)       f  (r⇛⊕ [])
    viewOrigin ([] <⊢ ._)       (r⇚⊕ f)     = go (([] <⇚ _) <⊢ _)       f  (r⇚⊕ [])
    viewOrigin ([] <⊢ ._)       (r◇□ f)     = go ((◇>   []) <⊢ _)       f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])

    private
      go : ∀ {I J B}
                     → (I⁺ : Polarised + I) (f : LG I [ el B ]ᴶ)
                     → {J⁺ : Polarised + J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
                     → Origin J⁺ (g [ f ]ᴰ)
      go I⁺ f {J⁺} g with viewOrigin I⁺ f
      ... | origin f′ pr = origin (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ ax ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g ax = cong (_[_]ᴰ g) pr




module □ where

  data Origin {J B} (J⁺ : Polarised + J) (f : LG J [ □ B ]ᴶ) : Set ℓ where
       origin : ∀ {A}
                → (h : LG B ⊢ A)
                → (f′ : ∀ {G} → LG G ⊢ □ A ⋯ J [ G ]ᴶ)
                → (pr : f ≡ f′ [ m□ h ]ᴰ)
                → Origin J⁺ f

  mutual
    viewOrigin : ∀ {J B} (J⁺ : Polarised + J) (f : LG J [ □ B ]ᴶ) → Origin J⁺ f
    viewOrigin ([] <⊢ ._)       (m□  f)     = origin f [] refl
    viewOrigin ([] <⊢ ._)       (r⊗⇒ f)     = go ((_ ⊗> []) <⊢ _)       f  (r⊗⇒ [])
    viewOrigin ([] <⊢ ._)       (r⊗⇐ f)     = go (([] <⊗ _) <⊢ _)       f  (r⊗⇐ [])
    viewOrigin ([] <⊢ ._)       (r⇛⊕ f)     = go ((_ ⇛> []) <⊢ _)       f  (r⇛⊕ [])
    viewOrigin ([] <⊢ ._)       (r⇚⊕ f)     = go (([] <⇚ _) <⊢ _)       f  (r⇚⊕ [])
    viewOrigin ([] <⊢ ._)       (r◇□ f)     = go ((◇>   []) <⊢ _)       f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])

    private
      go : ∀ {I J B}
         → (I⁺ : Polarised + I) (f : LG I [ □ B ]ᴶ)
         → {J⁺ : Polarised + J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
         → Origin J⁺ (g [ f ]ᴰ)
      go I⁺ f {J⁺} g with viewOrigin I⁺ f
      ... | origin h f′ pr = origin h (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ m□ h ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g (m□ h) = cong (_[_]ᴰ g) pr




module ◇ where

  data Origin {J B} (J⁻ : Polarised - J) (f : LG J [ ◇ B ]ᴶ) : Set ℓ where
       origin : ∀ {A}
                → (h : LG A ⊢ B)
                → (f′ : ∀ {G} → LG ◇ A ⊢ G ⋯ J [ G ]ᴶ)
                → (pr : f ≡ f′ [ m◇ h ]ᴰ)
                → Origin J⁻ f

  mutual
    viewOrigin : ∀ {J B} (J⁻ : Polarised - J) (f : LG J [ ◇ B ]ᴶ) → Origin J⁻ f
    viewOrigin (._ ⊢> [])       (m◇  f)     = origin f [] refl
    viewOrigin (._ ⊢> [])       (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> []))       f  (r⇒⊗ [])
    viewOrigin (._ ⊢> [])       (r⇐⊗ f)     = go (_ ⊢> ([] <⇐ _))       f  (r⇐⊗ [])
    viewOrigin (._ ⊢> [])       (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> []))       f  (r⊕⇛ [])
    viewOrigin (._ ⊢> [])       (r⊕⇚ f)     = go (_ ⊢> ([] <⊕ _))       f  (r⊕⇚ [])
    viewOrigin (._ ⊢> [])       (r□◇ f)     = go (_ ⊢> (□> []))         f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])

    private
      go : ∀ {I J B}
                     → (I⁻ : Polarised - I) (f : LG I [ ◇ B ]ᴶ)
                     → {J⁻ : Polarised - J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
                     → Origin J⁻ (g [ f ]ᴰ)
      go I⁻ f {J⁻} g with viewOrigin I⁻ f
      ... | origin h f′ pr = origin h (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ m◇ h ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g (m◇ h) = cong (_[_]ᴰ g) pr



module ⊗ where

  data Origin {J B C} (J⁻ : Polarised - J) (f : LG J [ B ⊗ C ]ᴶ) : Set ℓ where
       origin : ∀ {E F}
                → (h₁ : LG E ⊢ B) (h₂ : LG F ⊢ C)
                → (f′ : ∀ {G} → LG E ⊗ F ⊢ G ⋯ J [ G ]ᴶ)
                → (pr : f ≡ f′ [ m⊗ h₁ h₂ ]ᴰ)
                → Origin J⁻ f

  mutual
    viewOrigin : ∀ {J B C} (J⁻ : Polarised - J) (f : LG J [ B ⊗ C ]ᴶ) → Origin J⁻ f
    viewOrigin (._ ⊢> [])       (m⊗  f₁ f₂) = origin f₁ f₂ [] refl
    viewOrigin (._ ⊢> [])       (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> []))       f  (r⇒⊗ [])
    viewOrigin (._ ⊢> [])       (r⇐⊗ f)     = go (_ ⊢> ([] <⇐ _))       f  (r⇐⊗ [])
    viewOrigin (._ ⊢> [])       (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> []))       f  (r⊕⇛ [])
    viewOrigin (._ ⊢> [])       (r⊕⇚ f)     = go (_ ⊢> ([] <⊕ _))       f  (r⊕⇚ [])
    viewOrigin (._ ⊢> [])       (r□◇ f)     = go (_ ⊢> (□> []))         f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])

    private
      go : ∀ {I J B C}
                     → (I⁻ : Polarised - I) (f : LG I [ B ⊗ C ]ᴶ)
                     → {J⁻ : Polarised - J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
                     → Origin J⁻ (g [ f ]ᴰ)
      go I⁻ f {J⁻} g with viewOrigin I⁻ f
      ... | origin h₁ h₂ f′ pr = origin h₁ h₂ (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ m⊗ h₁ h₂ ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g (m⊗ h₁ h₂) = cong (_[_]ᴰ g) pr




module ⇚ where

  data Origin {J B C} (J⁻ : Polarised - J) (f : LG J [ B ⇚ C ]ᴶ) : Set ℓ where
       origin : ∀ {E F}
                → (h₁ : LG E ⊢ B) (h₂ : LG C ⊢ F)
                → (f′ : ∀ {G} → LG E ⇚ F ⊢ G ⋯ J [ G ]ᴶ)
                → (pr : f ≡ f′ [ m⇚ h₁ h₂ ]ᴰ)
                → Origin J⁻ f

  mutual
    viewOrigin : ∀ {J B C} (J⁻ : Polarised - J) (f : LG J [ B ⇚ C ]ᴶ) → Origin J⁻ f
    viewOrigin (._ ⊢> [])       (m⇚  f₁ f₂) = origin f₁ f₂ [] refl
    viewOrigin (._ ⊢> [])       (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> []))       f  (r⇒⊗ [])
    viewOrigin (._ ⊢> [])       (r⇐⊗ f)     = go (_ ⊢> ([] <⇐ _))       f  (r⇐⊗ [])
    viewOrigin (._ ⊢> [])       (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> []))       f  (r⊕⇛ [])
    viewOrigin (._ ⊢> [])       (r⊕⇚ f)     = go (_ ⊢> ([] <⊕ _))       f  (r⊕⇚ [])
    viewOrigin (._ ⊢> [])       (r□◇ f)     = go (_ ⊢> (□> []))         f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])

    private
      go : ∀ {I J B C}
                     → (I⁻ : Polarised - I) (f : LG I [ B ⇚ C ]ᴶ)
                     → {J⁻ : Polarised - J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
                     → Origin J⁻ (g [ f ]ᴰ)
      go I⁻ f {J⁻} g with viewOrigin I⁻ f
      ... | origin h₁ h₂ f′ pr = origin h₁ h₂ (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ m⇚ h₁ h₂ ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g (m⇚ h₁ h₂) = cong (_[_]ᴰ g) pr





module ⇛ where

  data Origin {J B C} (J⁻ : Polarised - J) (f : LG J [ B ⇛ C ]ᴶ) : Set ℓ where
       origin : ∀ {E F}
                → (h₁ : LG B ⊢ E) (h₂ : LG F ⊢ C)
                → (f′ : ∀ {G} → LG E ⇛ F ⊢ G ⋯ J [ G ]ᴶ)
                → (pr : f ≡ f′ [ m⇛ h₁ h₂ ]ᴰ)
                → Origin J⁻ f

  mutual
    viewOrigin : ∀ {J B C} (J⁻ : Polarised - J) (f : LG J [ B ⇛ C ]ᴶ) → Origin J⁻ f
    viewOrigin (._ ⊢> [])       (m⇛  f₁ f₂) = origin f₁ f₂ [] refl
    viewOrigin (._ ⊢> [])       (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> []))       f  (r⇒⊗ [])
    viewOrigin (._ ⊢> [])       (r⇐⊗ f)     = go (_ ⊢> ([] <⇐ _))       f  (r⇐⊗ [])
    viewOrigin (._ ⊢> [])       (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> []))       f  (r⊕⇛ [])
    viewOrigin (._ ⊢> [])       (r⊕⇚ f)     = go (_ ⊢> ([] <⊕ _))       f  (r⊕⇚ [])
    viewOrigin (._ ⊢> [])       (r□◇ f)     = go (_ ⊢> (□> []))         f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])

    private
      go : ∀ {I J B C}
                     → (I⁻ : Polarised - I) (f : LG I [ B ⇛ C ]ᴶ)
                     → {J⁻ : Polarised - J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
                     → Origin J⁻ (g [ f ]ᴰ)
      go I⁻ f {J⁻} g with viewOrigin I⁻ f
      ... | origin h₁ h₂ f′ pr = origin h₁ h₂ (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ m⇛ h₁ h₂ ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g (m⇛ h₁ h₂) = cong (_[_]ᴰ g) pr




module ⊕ where

  data Origin {J B C} (J⁺ : Polarised + J) (f : LG J [ B ⊕ C ]ᴶ) : Set ℓ where
       origin : ∀ {E F}
                → (h₁ : LG B ⊢ E) (h₂ : LG C ⊢ F)
                → (f′ : ∀ {G} → LG G ⊢ E ⊕ F ⋯ J [ G ]ᴶ)
                → (pr : f ≡ f′ [ m⊕ h₁ h₂ ]ᴰ)
                → Origin J⁺ f

  mutual
    viewOrigin : ∀ {J B C} (J⁺ : Polarised + J) (f : LG J [ B ⊕ C ]ᴶ) → Origin J⁺ f
    viewOrigin ([] <⊢ ._)       (m⊕  f₁ f₂) = origin f₁ f₂ [] refl
    viewOrigin ([] <⊢ ._)       (r⊗⇒ f)     = go ((_ ⊗> []) <⊢ _)       f  (r⊗⇒ [])
    viewOrigin ([] <⊢ ._)       (r⊗⇐ f)     = go (([] <⊗ _) <⊢ _)       f  (r⊗⇐ [])
    viewOrigin ([] <⊢ ._)       (r⇛⊕ f)     = go ((_ ⇛> []) <⊢ _)       f  (r⇛⊕ [])
    viewOrigin ([] <⊢ ._)       (r⇚⊕ f)     = go (([] <⇚ _) <⊢ _)       f  (r⇚⊕ [])
    viewOrigin ([] <⊢ ._)       (r◇□ f)     = go ((◇>   []) <⊢ _)       f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])

    private
      go : ∀ {I J B C}
                     → (I⁺ : Polarised + I) (f : LG I [ B ⊕ C ]ᴶ)
                     → {J⁺ : Polarised + J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
                     → Origin J⁺ (g [ f ]ᴰ)
      go I⁺ f {J⁺} g with viewOrigin I⁺ f
      ... | origin h₁ h₂ f′ pr = origin h₁ h₂ (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ m⊕ h₁ h₂ ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g (m⊕ h₁ h₂) = cong (_[_]ᴰ g) pr




module ⇐ where

  data Origin {J B C} (J⁺ : Polarised + J) (f : LG J [ B ⇐ C ]ᴶ) : Set ℓ where
       origin : ∀ {E F}
                → (h₁ : LG B ⊢ E) (h₂ : LG F ⊢ C)
                → (f′ : ∀ {G} → LG G ⊢ E ⇐ F ⋯ J [ G ]ᴶ)
                → (pr : f ≡ f′ [ m⇐ h₁ h₂ ]ᴰ)
                → Origin J⁺ f

  mutual
    viewOrigin : ∀ {J B C} (J⁺ : Polarised + J) (f : LG J [ B ⇐ C ]ᴶ) → Origin J⁺ f
    viewOrigin ([] <⊢ ._)       (m⇐  f₁ f₂) = origin f₁ f₂ [] refl
    viewOrigin ([] <⊢ ._)       (r⊗⇒ f)     = go ((_ ⊗> []) <⊢ _)       f  (r⊗⇒ [])
    viewOrigin ([] <⊢ ._)       (r⊗⇐ f)     = go (([] <⊗ _) <⊢ _)       f  (r⊗⇐ [])
    viewOrigin ([] <⊢ ._)       (r⇛⊕ f)     = go ((_ ⇛> []) <⊢ _)       f  (r⇛⊕ [])
    viewOrigin ([] <⊢ ._)       (r⇚⊕ f)     = go (([] <⇚ _) <⊢ _)       f  (r⇚⊕ [])
    viewOrigin ([] <⊢ ._)       (r◇□ f)     = go ((◇>   []) <⊢ _)       f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])

    private
      go : ∀ {I J B C}
                     → (I⁺ : Polarised + I) (f : LG I [ B ⇐ C ]ᴶ)
                     → {J⁺ : Polarised + J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
                     → Origin J⁺ (g [ f ]ᴰ)
      go I⁺ f {J⁺} g with viewOrigin I⁺ f
      ... | origin h₁ h₂ f′ pr = origin h₁ h₂ (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ m⇐ h₁ h₂ ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g (m⇐ h₁ h₂) = cong (_[_]ᴰ g) pr




module ⇒ where

  data Origin {J B C} (J⁺ : Polarised + J) (f : LG J [ B ⇒ C ]ᴶ) : Set ℓ where
       origin : ∀ {E F}
                → (h₁ : LG E ⊢ B) (h₂ : LG C ⊢ F)
                → (f′ : ∀ {G} → LG G ⊢ E ⇒ F ⋯ J [ G ]ᴶ)
                → (pr : f ≡ f′ [ m⇒ h₁ h₂ ]ᴰ)
                → Origin J⁺ f

  mutual
    viewOrigin : ∀ {J B C} (J⁺ : Polarised + J) (f : LG J [ B ⇒ C ]ᴶ) → Origin J⁺ f
    viewOrigin ([] <⊢ ._)       (m⇒  f₁ f₂) = origin f₁ f₂ [] refl
    viewOrigin ([] <⊢ ._)       (r⊗⇒ f)     = go ((_ ⊗> []) <⊢ _)       f  (r⊗⇒ [])
    viewOrigin ([] <⊢ ._)       (r⊗⇐ f)     = go (([] <⊗ _) <⊢ _)       f  (r⊗⇐ [])
    viewOrigin ([] <⊢ ._)       (r⇛⊕ f)     = go ((_ ⇛> []) <⊢ _)       f  (r⇛⊕ [])
    viewOrigin ([] <⊢ ._)       (r⇚⊕ f)     = go (([] <⇚ _) <⊢ _)       f  (r⇚⊕ [])
    viewOrigin ([] <⊢ ._)       (r◇□ f)     = go ((◇>   []) <⊢ _)       f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (m◇  f)     = go (A <⊢ _)               f  (m◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r□◇ f)     = go (A <⊢ _)               f  (r□◇ [])
    viewOrigin ((◇> A) <⊢ ._)   (r◇□ f)     = go ((◇> (◇> A)) <⊢ _)     f  (r◇□ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇒ f)     = go ((_ ⊗> (◇> A)) <⊢ _)   f  (r⊗⇒ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⊗⇐ f)     = go (((◇> A) <⊗ _) <⊢ _)   f  (r⊗⇐ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇛⊕ f)     = go ((_ ⇛> (◇> A)) <⊢ _)   f  (r⇛⊕ [])
    viewOrigin ((◇> A) <⊢ ._)   (r⇚⊕ f)     = go (((◇> A) <⇚ _) <⊢ _)   f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (□> B))   (m□  f)     = go (_ ⊢> B)               f  (m□ [])
    viewOrigin (._ ⊢> (□> B))   (r□◇ f)     = go (_ ⊢> (□> (□> B)))     f  (r□◇ [])
    viewOrigin (._ ⊢> (□> B))   (r◇□ f)     = go (_ ⊢> B)               f  (r◇□ [])
    viewOrigin (._ ⊢> (□> B))   (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (□> B)))   f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⇐⊗ f)     = go (_ ⊢> ((□> B) <⇐ _))   f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (□> B)))   f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (□> B))   (r⊕⇚ f)     = go (_ ⊢> ((□> B) <⊕ _))   f  (r⊕⇚ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⊗> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇛> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r◇□ f)     = go ((◇> (A ⇚> B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⊗ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇛ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r◇□ f)     = go ((◇> (A <⇚ B)) <⊢ _)   f  (r◇□ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⊕> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇒> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r□◇ f)     = go (_ ⊢> (□> (A ⇐> B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⊕ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇒ B)))   f  (r□◇ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r□◇ f)     = go (_ ⊢> (□> (A <⇐ B)))   f  (r□◇ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (m⊗  f₁ f₂) = go (B <⊢ _)               f₂ (m⊗ᴿ f₁ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇒⊗ f)     = go (B <⊢ _)               f  (r⇒⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⊗> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇐⊗ f)     = go (_ ⊢> (_ ⇐> B))        f  (r⇐⊗ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⊗> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⊗> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⊗> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⊗> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇛> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇛> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (m⇛  f₁ f₂) = go (B <⊢ _)               f₂ (m⇛ᴿ f₁ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇛> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⊕⇛ f)     = go (B <⊢ _)               f  (r⊕⇛ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇛> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇐ f)     = go ((B <⊗ _) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin ((A ⇛> B) <⊢ ._) (d⇛⇒ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A ⇚> B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊗⇐ f)     = go (((A ⇚> B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (m⇚  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇚ᴿ f₁ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A ⇚> B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⊕⇚ f)     = go (_ ⊢> (_ ⊕> B))        f  (r⊕⇚ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (r⇚⊕ f)     = go (((A ⇚> B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇒ [])
    viewOrigin ((A ⇚> B) <⊢ ._) (d⇚⇐ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇚⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (m⊗  f₁ f₂) = go (A <⊢ _)               f₁ (m⊗ᴸ [] f₂)
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇒⊗ f)     = go (_ ⊢> (A <⇒ _))        f  (r⇒⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⊗ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇐⊗ f)     = go (A <⊢ _)               f  (r⇐⊗ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⊗ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⊗ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⊗ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⊗ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇛ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇛ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (m⇛  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇛ᴸ [] f₂)
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇛ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⊕⇛ f)     = go (_ ⊢> (A <⊕ _))        f  (r⊕⇛ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇛ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇐ [])
    viewOrigin ((A <⇛ B) <⊢ ._) (d⇛⇒ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇛⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇒ f)     = go ((_ ⊗> (A <⇚ B)) <⊢ _) f  (r⊗⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊗⇐ f)     = go (((A <⇚ B) <⊗ _) <⊢ _) f  (r⊗⇐ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (m⇚  f₁ f₂) = go (A <⊢ _)               f₁ (m⇚ᴸ [] f₂)
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇛⊕ f)     = go ((_ ⇛> (A <⇚ B)) <⊢ _) f  (r⇛⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⊕⇚ f)     = go (A <⊢ _)               f  (r⊕⇚ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (r⇚⊕ f)     = go (((A <⇚ B) <⇚ _) <⊢ _) f  (r⇚⊕ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇒ f)     = go ((_ ⊗> A) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin ((A <⇚ B) <⊢ ._) (d⇚⇐ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⊕> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⊕> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (m⊕  f₁ f₂) = go (_ ⊢> B)               f₂ (m⊕ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇛⊕ f)     = go (_ ⊢> B)               f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⊕> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⊕> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⊕> B)) (r⇚⊕ f)     = go ((_ ⇚> B) <⊢ _)        f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (m⇒  f₁ f₂) = go (_ ⊢> B)               f₂ (m⇒ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇒> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊗⇒ f)     = go (_ ⊢> B)               f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇒> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇒> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇒> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇛⇒ f)     = go (_ ⊢> (_ ⊕> B))        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A ⇒> B)) (d⇚⇒ f)     = go (_ ⊢> (B <⊕ _))        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (m⇐  f₁ f₂) = go (B <⊢ _)               f₂ (m⇐ᴿ f₁ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A ⇐> B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⇐⊗ f)     = go (_ ⊢> ((A ⇐> B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊗⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A ⇐> B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (r⊕⇚ f)     = go (_ ⊢> ((A ⇐> B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇛⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A ⇐> B)) (d⇚⇐ f)     = go ((_ ⊗> B) <⊢ _)        f  (d⇚⇐ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⊕ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⊕ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (m⊕  f₁ f₂) = go (_ ⊢> A)               f₁ (m⊕ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇛⊕ f)     = go ((A <⇛ _) <⊢ _)        f  (r⇛⊕ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⊕ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⊕ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⊕ B)) (r⇚⊕ f)     = go (_ ⊢> A)               f  (r⇚⊕ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (m⇒  f₁ f₂) = go (A <⊢ _)               f₁ (m⇒ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇒ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊗⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (r⊗⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇒ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇒ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇒ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇛⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇛⇒ [])
    viewOrigin (._ ⊢> (A <⇒ B)) (d⇚⇒ f)     = go ((A <⊗ _) <⊢ _)        f  (d⇚⇒ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (m⇐  f₁ f₂) = go (_ ⊢> A)               f₁ (m⇐ᴸ [] f₂)
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇒⊗ f)     = go (_ ⊢> (_ ⇒> (A <⇐ B))) f  (r⇒⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⇐⊗ f)     = go (_ ⊢> ((A <⇐ B) <⇐ _)) f  (r⇐⊗ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊗⇐ f)     = go (_ ⊢> A)               f  (r⊗⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇛ f)     = go (_ ⊢> (_ ⊕> (A <⇐ B))) f  (r⊕⇛ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (r⊕⇚ f)     = go (_ ⊢> ((A <⇐ B) <⊕ _)) f  (r⊕⇚ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇛⇐ f)     = go (_ ⊢> (_ ⊕> A))        f  (d⇛⇐ [])
    viewOrigin (._ ⊢> (A <⇐ B)) (d⇚⇐ f)     = go (_ ⊢> (A <⊕ _))        f  (d⇚⇐ [])

    private
      go : ∀ {I J B C}
                     → (I⁺ : Polarised + I) (f : LG I [ B ⇒ C ]ᴶ)
                     → {J⁺ : Polarised + J} (g : ∀ {G} → LG I [ G ]ᴶ ⋯ J [ G ]ᴶ)
                     → Origin J⁺ (g [ f ]ᴰ)
      go I⁺ f {J⁺} g with viewOrigin I⁺ f
      ... | origin h₁ h₂ f′ pr = origin h₁ h₂ (g < f′ >ᴰ) pr′
        where
          pr′ : g [ f ]ᴰ ≡ (g < f′ >ᴰ) [ m⇒ h₁ h₂ ]ᴰ
          pr′ rewrite <>ᴰ-def f′ g (m⇒ h₁ h₂) = cong (_[_]ᴰ g) pr
